<!DOCTYPE html>
<html lang="tg">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TradeWay TJ ‚Äî –ú–∞–≥–∞–∑–∏–Ω</title>
<style>
body { font-family: Arial, sans-serif; background: #f7f8fa; margin: 0; padding: 0; }
header { background: #007bff; color: #fff; padding: 15px; text-align: center; font-size: 20px; font-weight: bold; }
.container { padding: 15px; }
.category-list, .product-list, .cart { background: #fff; padding: 15px; border-radius: 10px; box-shadow: 0 0 6px rgba(0,0,0,0.1); margin-bottom: 20px; }
.category { background: #e9ecef; padding: 10px; border-radius: 8px; margin: 5px 0; cursor: pointer; transition: 0.3s; }
.category:hover { background: #ced4da; }
button { background: #007bff; color: white; border: none; padding: 6px 12px; border-radius: 5px; cursor: pointer; }
button:hover { background: #0056b3; }
.hidden { display: none; }
.cart-item { margin-bottom: 5px; }
input { width: 90%; padding: 8px; margin: 5px 0; border-radius: 6px; border: 1px solid #ccc; }
</style>
</head>
<body>

<header>üõç TradeWay TJ</header>

<div class="container">
  <div id="categories" class="category-list"></div>
  <div id="products" class="product-list hidden"></div>
  <div id="cart" class="cart hidden">
    <h3>üõí –°–∞–±–∞–¥</h3>
    <div id="cart-items"></div>
    <p><b>“≤–∞–º–∞–≥”£:</b> <span id="total">0</span> —Å–æ–º–æ–Ω”£</p>

    <input type="text" id="name" placeholder="–ù–æ–º"><br>
    <input type="text" id="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω"><br>
    <input type="text" id="address" placeholder="–°—É—Ä–æ“ì–∞"><br>

    <button onclick="sendOrder()">üì¶ –§–∞—Ä–º–æ–∏—à –¥–æ–¥–∞–Ω</button>
    <button onclick="closeCart()">‚¨ÖÔ∏è –ë–æ–∑–≥–∞—à—Ç</button>
  </div>
</div>

<footer style="text-align:center;padding:10px;">
  <button onclick="openCart()">üõí –°–∞–±–∞–¥</button>
</footer>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbydkrOnh6EGUB89wrf3xo8y1hg_6nDJyOAwCCl4yFmk7ZtQFbBbv32C9APuSfJoyJGr/exec";

// –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (–º–æ–∂–Ω–æ –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å –∏–∑ Google Sheets)
const categories = {
  "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞": [
    { name: "–¢–µ–ª–µ—Ñ–æ–Ω", price: 1500 },
    { name: "–ù–∞—É—à–Ω–∏–∫–∏", price: 200 },
    { name: "–ó–∞—Ä—è–¥–∫–∞", price: 80 }
  ],
  "–ö–∞–Ω—Ü–µ–ª—è—Ä–∏—è": [
    { name: "–†—É—á–∫–∞", price: 10 },
    { name: "–¢–µ—Ç—Ä–∞–¥—å", price: 20 },
    { name: "–°—É–º–∫–∞", price: 120 }
  ],
  "–õ–∏–±–æ—Å (–û–¥–µ–∂–¥–∞)": [
    { name: "–§—É—Ç–±–æ–ª–∫–∞", price: 100 },
    { name: "–®—Ç–∞–Ω—ã", price: 150 },
    { name: "–ö—É—Ä—Ç–∫–∞", price: 300 }
  ],
  "–ü–æ–π–∞—Ñ–∑–æ–ª (–û–±—É–≤—å)": [
    { name: "–ö—Ä–∞—Å–æ–≤–∫–∞", price: 250 },
    { name: "–ë–∞—à–º–∞–∫", price: 200 }
  ],
  "–ü–æ—Å—Ç–µ–ª—å–Ω–æ–µ –±–µ–ª—å—ë": [
    { name: "–ö–æ–º–ø–ª–µ–∫—Ç 1", price: 400 },
    { name: "–ö–æ–º–ø–ª–µ–∫—Ç 2", price: 600 }
  ],
  "–ê—Ç—Ä (–î—É—Ö–∏)": [
    { name: "Dior Sauvage", price: 800 },
    { name: "Versace Eros", price: 900 }
  ]
};

let cart = [];

function loadCategories() {
  const container = document.getElementById("categories");
  container.innerHTML = "";
  Object.keys(categories).forEach(cat => {
    container.innerHTML += `<div class="category" onclick="openCategory('${cat}')">${cat}</div>`;
  });
}

function openCategory(cat) {
  const list = document.getElementById("products");
  const cats = document.getElementById("categories");
  cats.classList.add("hidden");
  list.classList.remove("hidden");

  list.innerHTML = `<h3>${cat}</h3>`;
  categories[cat].forEach(p => {
    list.innerHTML += `
      <div class="product">
        <b>${p.name}</b> ‚Äî ${p.price} —Å–æ–º–æ–Ω”£ 
        <button onclick="addToCart('${p.name}', ${p.price})">‚ûï –°–∞–±–∞–¥</button>
      </div>`;
  });
  list.innerHTML += `<br><button onclick="backToCategories()">‚¨ÖÔ∏è –ë–æ–∑–≥–∞—à—Ç</button>`;
}

function backToCategories() {
  document.getElementById("products").classList.add("hidden");
  document.getElementById("categories").classList.remove("hidden");
}

function addToCart(name, price) {
  cart.push({ name, price });
  alert(name + " –±–∞ —Å–∞–±–∞–¥ –∏–ª–æ–≤–∞ —à—É–¥!");
}

function openCart() {
  document.getElementById("categories").classList.add("hidden");
  document.getElementById("products").classList.add("hidden");
  document.getElementById("cart").classList.remove("hidden");
  updateCart();
}

function closeCart() {
  document.getElementById("cart").classList.add("hidden");
  document.getElementById("categories").classList.remove("hidden");
}

function updateCart() {
  const items = document.getElementById("cart-items");
  items.innerHTML = "";
  let total = 0;
  cart.forEach((item, i) => {
    total += item.price;
    items.innerHTML += `<div class="cart-item">${item.name} ‚Äî ${item.price} —Å–æ–º–æ–Ω”£ 
      <button onclick="removeItem(${i})">‚ùå</button></div>`;
  });
  document.getElementById("total").innerText = total;
}

function removeItem(i) {
  cart.splice(i, 1);
  updateCart();
}

async function sendOrder() {
  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const address = document.getElementById("address").value.trim();
  const total = document.getElementById("total").innerText;

  if (!name || !phone || cart.length === 0) {
    alert("–õ—É—Ç—Ñ–∞–Ω –º–∞—ä–ª—É–º–æ—Ç—Ä–æ –ø—É—Ä –∫—É–Ω–µ–¥."); 
    return;
  }

  const payload = {
    type: "order",
    customer: { name, phone, address },
    items: cart,
    total: Number(total),
    currency: "—Å–æ–º–æ–Ω”£"
  };

  try {
    await fetch(GAS_URL, {
      method: "POST",
      mode: "no-cors",
      body: JSON.stringify(payload)
    });
    alert("‚úÖ –§–∞—Ä–º–æ–∏—à —Ñ–∏—Ä–∏—Å—Ç–æ–¥–∞ —à—É–¥!");
    cart = [];
    closeCart();
  } catch (e) {
    alert("‚ùå –•–∞—Ç–æ–≥”£: " + e.message);
  }
}

loadCategories();
</script>
</body>
</html>
