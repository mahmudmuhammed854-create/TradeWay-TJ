<!doctype html>
<html lang="tg">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TradeWay TJ ‚Äî –î”Ø–∫–æ–Ω–∏ –æ–Ω–ª–∞–π–Ω</title>
  <meta name="description" content="–î”Ø–∫–æ–Ω–∏ –æ–Ω–ª–∞–π–Ω –±–æ —Å–∞–±–∞–¥–∏ —Ñ–∞—ä–æ–ª –≤–∞ –∏–ª–æ–≤–∞–∏ –º–∞“≥—Å—É–ª–æ—Ç —Ç–∞–Ω“≥–æ –±–∞—Ä–æ–∏ –∞–¥–º–∏–Ω">
  <style>
    :root {
      --bg:#0f172a; --surface:#111827; --muted:#94a3b8; --text:#e5e7eb;
      --primary:#22c55e; --card:#0b1220; --border:#1f2937;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      background:linear-gradient(180deg,var(--bg),#0b1022 40%,#0b0f1a);
      color:var(--text);
      font:15px/1.5 Inter,system-ui,Segoe UI,Roboto,Arial;
      min-height:100vh;
      overflow-x:hidden;
    }
    .container{max-width:1200px;margin:0 auto;padding:0 16px}
    header{position:sticky;top:0;z-index:50;backdrop-filter:saturate(140%) blur(10px);background:rgba(10,14,25,.8);border-bottom:1px solid var(--border)}
    .nav{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px;padding:10px 0}
    .brand{display:flex;align-items:center;gap:8px;font-weight:700;font-size:18px}
    .brand .dot{width:10px;height:10px;border-radius:50%;background:conic-gradient(var(--primary),#10b981)}
    .actions{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .input{display:flex;align-items:center;gap:8px;background:#0b1325;border:1px solid var(--border);border-radius:12px;padding:6px 10px;flex:1;min-width:180px}
    .input input{all:unset;color:var(--text);width:100%}
    .btn{border:1px solid var(--border);background:#0c152a;padding:8px 12px;border-radius:12px;color:var(--text);cursor:pointer;transition:.2s ease;display:inline-flex;align-items:center;gap:6px;font-size:14px}
    .btn.primary{background:linear-gradient(180deg,#22c55e,#16a34a);border-color:#1a2c22;color:#04170b;font-weight:600}
    .btn:hover{transform:translateY(-1px);box-shadow:0 6px 18px rgba(0,0,0,.25)}

    .hero{text-align:center;padding:24px 0 8px}
    .title{font-size:24px;font-weight:800}
    .subtitle{color:var(--muted);font-size:14px}

    .categories{display:flex;flex-wrap:wrap;justify-content:center;gap:10px;margin:15px 0}
    .cat-btn{background:#0c152a;border:1px solid var(--border);padding:6px 12px;border-radius:10px;cursor:pointer;transition:0.2s}
    .cat-btn:hover{background:#1e293b}
    .cat-btn.active{background:var(--primary);color:#04170b;font-weight:600}

    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;padding-bottom:40px}
    .card{background:linear-gradient(180deg,#0a1220,var(--card));border:1px solid var(--border);border-radius:16px;overflow:hidden;display:flex;flex-direction:column;transition:transform .3s ease}
    .card:hover{transform:translateY(-3px)}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block}
    .body{padding:12px;display:flex;flex-direction:column;gap:8px}
    .name{font-weight:600;font-size:15px}
    .price{font-weight:700;font-size:16px;color:#bbf7d0}

    /* Cart */
    .cart-overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);backdrop-filter:blur(2px);display:none;z-index:60}
    .cart{position:fixed;right:0;top:0;height:100vh;width:350px;max-width:100%;background:#0b1325;border-left:1px solid var(--border);box-shadow:-10px 0 30px rgba(0,0,0,.3);transform:translateX(105%);transition:transform .25s ease;z-index:61;display:flex;flex-direction:column}
    .cart.open{transform:translateX(0)}
    .cart-header{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--border)}
    .cart-items{padding:10px;overflow:auto;flex:1}
    .cart-row{display:grid;grid-template-columns:64px 1fr auto;gap:8px;align-items:center;padding:8px;border:1px solid var(--border);border-radius:10px;background:#0a1324;margin-bottom:8px}
    .cart-row img{width:64px;height:64px;object-fit:cover;border-radius:8px}
    .cart-footer{border-top:1px solid var(--border);padding:12px;display:grid;gap:8px}
    .total{display:flex;align-items:center;justify-content:space-between;font-weight:800}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand"><span class="dot"></span><span>TradeWay TJ</span></div>
      <div class="input"><input id="search" placeholder="“∂—É—Å—Ç—É“∑”Ø–∏ –º–∞“≥—Å—É–ª–æ—Ç..." /></div>
      <div class="actions"><button id="openCart" class="btn">üõí –°–∞–±–∞–¥ <span id="cartCount">0</span></button></div>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <h1 class="title">–ö–∞—Ç–µ–≥–æ—Ä–∏—è“≥–æ</h1>
      <div id="categories" class="categories"></div>
    </section>
    <section><div id="grid" class="grid"></div></section>
  </main>

  <div id="overlay" class="cart-overlay"></div>
  <aside id="cartPanel" class="cart">
    <div class="cart-header">
      <strong>–°–∞–±–∞–¥</strong>
      <button id="closeCart" class="btn">‚úï</button>
    </div>
    <div id="cartItems" class="cart-items"></div>
    <div class="cart-footer">
      <div class="total">“≤–∞–º–∞–≥”£: <span id="cartTotal">0 —Å–æ–º–æ–Ω”£</span></div>
      <button id="checkout" class="btn primary">–§–∏—Ä–∏—Å—Ç–æ–¥–∞–Ω–∏ —Ñ–∞—Ä–º–æ–∏—à</button>
      <button id="clear" class="btn" style="background:#581515;color:#fff">–ü–æ–∫ –∫–∞—Ä–¥–∞–Ω–∏ —Å–∞–±–∞–¥</button>
    </div>
  </aside>

  <script>
    const ADMIN_PASS = "12345"; // üîë –ü–æ–º–µ–Ω—è–π –Ω–∞ —Å–≤–æ–π –ø–∞—Ä–æ–ª—å
    let isAdmin = false;

    const state = { products: [], cart: new Map(), filter: '“≤–∞–º–∞' };
    const fmt = n => n.toLocaleString('ru-RU');

    const grid = document.getElementById('grid');
    const catsDiv = document.getElementById('categories');
    const search = document.getElementById('search');

    const defaultProducts = [
      {id:1, cat:'–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞', name:'–°–∞–º—Å—É–Ω–≥ –ê4', price:600, img:'https://iili.io/KmrTpyX.jpg'},
      {id:2, cat:'–õ–∏–±–æ—Å', name:'–ö—É—Ä—Ç–∫–∞', price:900, img:'https://iili.io/KmrYKGa.jpg'},
      {id:3, cat:'–ü–æ–π–∞—Ñ–∑–æ–ª', name:'–ö–µ–¥—ã', price:2500, img:'https://iili.io/KmrlFYx.jpg'}
    ];

    const saved = localStorage.getItem('products');
    state.products = saved ? JSON.parse(saved) : [...defaultProducts];
    const cats = ['“≤–∞–º–∞', ...new Set(state.products.map(p => p.cat))];

    function renderCats() {
      catsDiv.innerHTML = cats.map(c =>
        `<button class='cat-btn ${state.filter===c?'active':''}' onclick='setCat("${c}")'>${c}</button>`
      ).join('');
    }

    function setCat(c){ state.filter = c; renderCats(); renderGrid(); }

    function card(p){
      return `<article class='card'>
        <div class='thumb'><img src='${p.img}' alt='${p.name}'></div>
        <div class='body'>
          <div class='name'>${p.name}</div>
          <div class='price'>${fmt(p.price)} —Å–æ–º–æ–Ω”£</div>
          <div style="display:flex;gap:6px;">
            <button class='btn' onclick='updateCart(${p.id},1)'>üõí –°–∞–±–∞–¥</button>
            ${isAdmin ? `<button class='btn' style='background:#7f1d1d;color:white;' onclick='deleteProduct(${p.id})'>üóëÔ∏è –ü–æ–∫ –∫–∞—Ä–¥–∞–Ω</button>` : ""}
          </div>
        </div>
      </article>`;
    }

    function renderGrid(){
      let q = search.value.toLowerCase();
      let list = state.products.filter(p =>
        (state.filter==='“≤–∞–º–∞' || p.cat===state.filter) &&
        p.name.toLowerCase().includes(q)
      );
      grid.innerHTML = list.map(card).join('') || "<p>–ú–∞“≥—Å—É–ª–æ—Ç —ë—Ñ—Ç –Ω–∞—à—É–¥ üòï</p>";
    }

    function updateCart(id,delta){
      const p=state.products.find(x=>x.id===id);
      if(!p)return;
      const item=state.cart.get(id)||{product:p,qty:0};
      item.qty=Math.max(0,item.qty+delta);
      if(item.qty===0)state.cart.delete(id);
      else state.cart.set(id,item);
      renderCart();
    }

    function renderCart(){
      const cI=document.getElementById('cartItems');
      let total=0,count=0;
      cI.innerHTML='';
      state.cart.forEach(({product,qty})=>{
        total+=product.price*qty;
        count+=qty;
        cI.innerHTML+=`<div class='cart-row'>
          <img src='${product.img}'><div><div>${product.name}</div>
          <div>${fmt(product.price)} —Å–æ–º–æ–Ω”£ √ó ${qty}</div></div>
          <div><button onclick='updateCart(${product.id},-1)'>‚àí</button>
          <span>${qty}</span><button onclick='updateCart(${product.id},1)'>+</button></div>
        </div>`;
      });
      document.getElementById('cartTotal').textContent=fmt(total)+' —Å–æ–º–æ–Ω”£';
      document.getElementById('cartCount').textContent=count;
    }

    function deleteProduct(id){
      if(!confirm('–®—É–º–æ –º—É—Ç–º–∞–∏–Ω “≥–∞—Å—Ç–µ–¥, –∫–∏ –º–µ—Ö–æ“≥–µ–¥ –∏–Ω –º–∞“≥—Å—É–ª–æ—Ç—Ä–æ –ø–æ–∫ –∫—É–Ω–µ–¥?'))return;
      state.products = state.products.filter(p => p.id !== id);
      localStorage.setItem('products', JSON.stringify(state.products));
      renderGrid();
      alert('‚ùå –ú–∞“≥—Å—É–ª–æ—Ç –ø–æ–∫ –∫–∞—Ä–¥–∞ —à—É–¥');
    }

    function openCart(){document.getElementById('cartPanel').classList.add('open');document.getElementById('overlay').style.display='block';}
    function closeCart(){document.getElementById('cartPanel').classList.remove('open');document.getElementById('overlay').style.display='none';}

    document.getElementById('openCart').addEventListener('click',openCart);
    document.getElementById('closeCart').addEventListener('click',closeCart);
    document.getElementById('overlay').addEventListener('click',closeCart);
    document.getElementById('clear').addEventListener('click',()=>{state.cart.clear();renderCart();});
    search.addEventListener('input',renderGrid);

    renderCats(); renderGrid();

    // --- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω) ---
    function addButtonIfAdmin(){
      if(!isAdmin)return;
      const addBtn = document.createElement('button');
      addBtn.className='btn primary';
      addBtn.textContent='‚ûï –ò–ª–æ–≤–∞–∏ –º–∞“≥—Å—É–ª–æ—Ç';
      addBtn.style.margin='20px auto';
      addBtn.onclick = ()=>openAddForm();
      document.querySelector('main').appendChild(addBtn);
    }

    function openAddForm(){
      const form = document.createElement('div');
      form.innerHTML = `
        <div style="background:#0b1325;padding:20px;border-radius:12px;max-width:350px;margin:20px auto;border:1px solid #1f2937">
          <h3>‚ûï –ú–∞“≥—Å—É–ª–æ—Ç–∏ –Ω–∞–≤</h3><br>
          <input id="newCat" placeholder="–ö–∞—Ç–µ–≥–æ—Ä–∏—è" class="input" style="width:100%;margin-bottom:8px">
          <input id="newName" placeholder="–ù–æ–º" class="input" style="width:100%;margin-bottom:8px">
          <input id="newPrice" placeholder="–ù–∞—Ä—Ö" type="number" class="input" style="width:100%;margin-bottom:8px">
          <input id="newImg" placeholder="–°—Å—ã–ª–∫–∞ –±–∞ —Ä–∞—Å–º" class="input" style="width:100%;margin-bottom:8px">
          <button class="btn primary" id="saveProduct" style="width:100%">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>`;
      document.body.appendChild(form);
      document.getElementById('saveProduct').onclick = ()=>{
        const cat=document.getElementById('newCat').value;
        const name=document.getElementById('newName').value;
        const price=parseFloat(document.getElementById('newPrice').value);
        const img=document.getElementById('newImg').value;
        if(!cat||!name||!price||!img){alert('–õ—É—Ç—Ñ–∞–Ω “≥–∞–º–∞–∏ –º–∞–π–¥–æ–Ω“≥–æ—Ä–æ –ø—É—Ä –∫—É–Ω–µ–¥!');return;}
        const newProd={id:Date.now(),cat,name,price,img};
        state.products.push(newProd);
        localStorage.setItem('products', JSON.stringify(state.products));
        if(!cats.includes(cat))cats.push(cat);
        renderCats(); renderGrid();
        form.remove();
        alert('‚úÖ –ú–∞“≥—Å—É–ª–æ—Ç –∏–ª–æ–≤–∞ —à—É–¥ –≤–∞ –Ω–∏–≥–æ“≥ –¥–æ—à—Ç–∞ —à—É–¥!');
      }
    }

    // üîê –ó–∞–ø—Ä–æ—Å –ø–∞—Ä–æ–ª—è –ø—Ä–∏ –≤—Ö–æ–¥–µ
    window.onload = ()=>{
      const pass = prompt("–ü–∞—Ä–æ–ª–∏ –∞–¥–º–∏–Ω—Ä–æ –≤–æ—Ä–∏–¥ –∫—É–Ω–µ–¥ (—ë —Ö–æ–ª”£ –≥—É–∑–æ—Ä–µ–¥):");
      if(pass === ADMIN_PASS){
        isAdmin = true;
        alert("üî• –®—É–º–æ “≥–∞–º—á—É–Ω –∞–¥–º–∏–Ω –¥–∞—Ä–æ–º–∞–¥–µ–¥!");
      } else {
        isAdmin = false;
        alert("üë§ –†–µ“∑–∞–∏ –º—É—à—Ç–∞—Ä”£ —Ñ–∞—ä–æ–ª –∞—Å—Ç");
      }
      renderCats();
      renderGrid();
      addButtonIfAdmin();
    };
  </script>
</body>
</html>
