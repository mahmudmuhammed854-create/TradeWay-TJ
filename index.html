<!doctype html>
<html lang="tg">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TradeWay TJ ‚Äî –î”Ø–∫–æ–Ω–∏ –æ–Ω–ª–∞–π–Ω</title>
  <meta name="description" content="–î”Ø–∫–æ–Ω–∏ –æ–Ω–ª–∞–π–Ω –±–æ —Å–∞–±–∞–¥–∏ —Ñ–∞—ä–æ–ª –≤–∞ –∏—Ä—Å–æ–ª–∏ —Ñ–∞—Ä–º–æ–∏—à –±–∞ Google Apps Script">
  <style>
    :root{
      --bg:#0f172a; --surface:#111827; --muted:#94a3b8; --text:#e5e7eb;
      --primary:#22c55e; --ring:rgba(34,197,94,.35); --card:#0b1220;
      --border:#1f2937; --danger:#ef4444; --warn:#f59e0b;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#0b1022 40%,#0b0f1a);color:var(--text);font:16px/1.5 Inter,system-ui,Segoe UI,Roboto,Arial}
    a{color:inherit}
    .container{max-width:1200px;margin:0 auto;padding:0 20px}

    header{position:sticky;top:0;z-index:50;backdrop-filter:saturate(140%) blur(10px);background:rgba(10,14,25,.6);border-bottom:1px solid var(--border)}
    .nav{display:flex;align-items:center;gap:16px;justify-content:space-between;padding:14px 0}
    .brand{display:flex;align-items:center;gap:10px;font-weight:700;letter-spacing:.5px}
    .brand .dot{width:10px;height:10px;border-radius:50%;background:conic-gradient(var(--primary),#10b981)}
    .actions{display:flex;gap:10px;align-items:center}
    .input{display:flex;align-items:center;gap:8px;background:#0b1325;border:1px solid var(--border);border-radius:14px;padding:8px 12px;min-width:260px}
    .input input{all:unset;color:var(--text);width:100%}
    .btn{border:1px solid var(--border);background:#0c152a;padding:10px 14px;border-radius:14px;color:var(--text);cursor:pointer;transition:.2s ease;display:inline-flex;align-items:center;gap:8px}
    .btn:hover{transform:translateY(-1px);box-shadow:0 6px 18px rgba(0,0,0,.25)}
    .btn.primary{background:linear-gradient(180deg,#22c55e,#16a34a);border-color:#1a2c22;color:#04170b}

    .hero{padding:36px 0 8px}
    .hero .wrap{display:flex;gap:20px;align-items:center;justify-content:space-between}
    .title{font-size:28px;font-weight:800;line-height:1.2;margin:0}
    .subtitle{margin:6px 0 0;color:var(--muted)}

    .controls{display:flex;gap:10px;flex-wrap:wrap;margin:16px 0}
    .select{appearance:none;background:#0b1325;border:1px solid var(--border);border-radius:12px;color:var(--text);padding:10px 12px}

    .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
    @media (max-width:1024px){.grid{grid-template-columns:repeat(3,1fr)}}
    @media (max-width:768px){.grid{grid-template-columns:repeat(2,1fr)}.input{min-width:unset;width:100%}}
    @media (max-width:480px){.grid{grid-template-columns:1fr}}

    .card{background:linear-gradient(180deg,#0a1220,var(--card));border:1px solid var(--border);border-radius:18px;overflow:hidden;display:flex;flex-direction:column;min-height:100%}
    .thumb{aspect-ratio:4/3;background:#0a0e18;position:relative;overflow:hidden}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .35s ease}
    .card:hover .thumb img{transform:scale(1.05)}
    .badge{position:absolute;left:10px;top:10px;background:rgba(34,197,94,.1);color:#a7f3d0;border:1px solid #065f46;padding:4px 8px;border-radius:999px;font-size:12px}
    .body{padding:14px;display:flex;flex-direction:column;gap:10px}
    .name{font-weight:700}
    .price{display:flex;align-items:baseline;gap:8px}
    .price .new{font-size:18px;font-weight:800;color:#bbf7d0}
    .price .old{text-decoration:line-through;color:#64748b}
    .meta{color:var(--muted);font-size:13px}
    .qty{display:flex;gap:8px;align-items:center}
    .qty button{width:30px;height:30px;border-radius:10px;border:1px solid var(--border);background:#0c152a;color:var(--text);cursor:pointer}
    .add{margin-top:auto}

    .cart-overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);backdrop-filter:blur(2px);display:none;z-index:60}
    .cart{position:fixed;right:0;top:0;height:100dvh;width:380px;max-width:100%;background:#0b1325;border-left:1px solid var(--border);box-shadow:-10px 0 30px rgba(0,0,0,.3);transform:translateX(105%);transition:transform .25s ease;z-index:61;display:flex;flex-direction:column}
    .cart.open{transform:translateX(0)}
    .cart-header{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid var(--border)}
    .cart-items{padding:10px 12px;overflow:auto;flex:1}
    .cart-row{display:grid;grid-template-columns:64px 1fr auto;gap:10px;align-items:center;padding:10px;border:1px solid var(--border);border-radius:12px;background:#0a1324;margin-bottom:10px}
    .cart-row img{width:64px;height:64px;object-fit:cover;border-radius:10px}
    .cart-footer{border-top:1px solid var(--border);padding:12px 16px;display:grid;gap:10px}
    .total{display:flex;align-items:center;justify-content:space-between;font-weight:800}
    .danger{background:linear-gradient(180deg,var(--danger),#b91c1c);border-color:#7f1d1d;color:#fff}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand"><span class="dot"></span><span>TradeWay TJ</span></div>
      <div class="input"><input id="q" placeholder="“∂—É—Å—Ç—É“∑”Ø–∏ –º–∞“≥—Å—É–ª–æ—Ç..." /></div>
      <div class="actions">
        <select id="sort" class="select">
          <option value="popular">–ú–∞—à“≥—É—Ä</option>
          <option value="price_asc">–ù–∞—Ä—Ö: –∞–∑ –∞—Ä–∑–æ–Ω —Ç–æ –≥–∞—Ä–æ–Ω</option>
          <option value="price_desc">–ù–∞—Ä—Ö: –∞–∑ –≥–∞—Ä–æ–Ω —Ç–æ –∞—Ä–∑–æ–Ω</option>
        </select>
        <button id="openCart" class="btn">üõí –°–∞–±–∞–¥ <span id="cartCount">0</span></button>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <h1 class="title">–ö–∞—Ç–∞–ª–æ–≥–∏ –º–∞“≥—Å—É–ª–æ—Ç</h1>
      <p class="subtitle">–ú–∞“≥—Å—É–ª–æ—Ç—Ä–æ –∏–Ω—Ç–∏—Ö–æ–± –∫—É–Ω–µ–¥ –≤–∞ —Ñ–∞—Ä–º–æ–∏—à —Ñ–∏—Ä–∏—Å—Ç–µ–¥.</p>
    </section>
    <section><div id="grid" class="grid"></div></section>
  </main>

  <div id="overlay" class="cart-overlay"></div>
  <aside id="cartPanel" class="cart">
    <div class="cart-header">
      <strong>–°–∞–±–∞–¥</strong>
      <button id="closeCart" class="btn">‚úï</button>
    </div>
    <div id="cartItems" class="cart-items"></div>
    <div class="cart-footer">
      <div class="total">“≤–∞–º–∞–≥”£: <span id="cartTotal">0 —Å–æ–º–æ–Ω”£</span></div>
      <button id="checkout" class="btn primary">–§–∏—Ä–∏—Å—Ç–æ–¥–∞–Ω–∏ —Ñ–∞—Ä–º–æ–∏—à</button>
      <button id="clear" class="btn danger">–ü–æ–∫ –∫–∞—Ä–¥–∞–Ω–∏ —Å–∞–±–∞–¥</button>
    </div>
  </aside>

  <script>
    const SCRIPT_URL='https://script.google.com/macros/s/AKfycbzdTlOP4ZsnzUT9mVddBtV5uqef_t6fq9jaAf_b6nBhio7eKR_g3dH3wnkUfQweh59j/exec';
    const products=[
      {id:1,name:'–°–æ–∞—Ç–∏ Minimal',price:4990,img:'https://picsum.photos/seed/watch/800/600'},
      {id:2,name:'–ì”Ø—à–º–æ–Ω–∞–∫–∏ —Å–∞–¥–æ‚Äë–±–∞—Ä–∞–Ω–¥–∞',price:12990,img:'https://picsum.photos/seed/headphones/800/600'},
      {id:3,name:'–ö—Ä–∞—Å—Å–æ–≤–∫–∞“≥–æ',price:6990,img:'https://picsum.photos/seed/sneakers/800/600'},
      {id:4,name:'–°–º–∞—Ä—Ç—Ñ–æ–Ω',price:19990,img:'https://picsum.photos/seed/phone/800/600'}
    ];
    const state={cart:new Map()};
    const fmt=n=>n.toLocaleString('ru-RU');
    function card(p){return`<article class='card'><div class='thumb'><img src='${p.img}' alt='${p.name}'></div><div class='body'><div class='name'>${p.name}</div><div class='price'>${fmt(p.price)} —Å–æ–º–æ–Ω”£</div><button class='btn add' onclick='updateCart(${p.id},1)'>–ò–ª–æ–≤–∞ –±–∞ —Å–∞–±–∞–¥</button></div></article>`;}
    const grid=document.getElementById('grid');
    function renderGrid(){grid.innerHTML=products.map(card).join('');}
    function updateCart(id,delta){const p=products.find(x=>x.id===id);if(!p)return;const item=state.cart.get(id)||{product:p,qty:0};item.qty=Math.max(0,item.qty+delta);if(item.qty===0)state.cart.delete(id);else state.cart.set(id,item);renderCart();}
    function renderCart(){const cI=document.getElementById('cartItems');let total=0,count=0;cI.innerHTML='';state.cart.forEach(({product,qty})=>{total+=product.price*qty;count+=qty;cI.innerHTML+=`<div class='cart-row'><img src='${product.img}' alt='${product.name}'><div><div class='row-title'>${product.name}</div><div class='row-meta'>${fmt(product.price)} —Å–æ–º–æ–Ω”£ √ó ${qty}</div></div><div class='row-actions'><button onclick='updateCart(${product.id},-1)'>‚àí</button><span>${qty}</span><button onclick='updateCart(${product.id},1)'>+</button></div></div>`;});document.getElementById('cartTotal').textContent=fmt(total)+' —Å–æ–º–æ–Ω”£';document.getElementById('cartCount').textContent=count;}
    function openCart(){document.getElementById('cartPanel').classList.add('open');document.getElementById('overlay').style.display='block';}
    function closeCart(){document.getElementById('cartPanel').classList.remove('open');document.getElementById('overlay').style.display='none';}
    async function sendOrder(cart){try{const items=Array.from(cart.values()).map(({product,qty})=>({id:product.id,name:product.name,price:product.price,qty,subtotal:product.price*qty}));const total=items.reduce((s,i)=>s+i.subtotal,0);const order={action:'order',items,total,currency:'—Å–æ–º–æ–Ω”£',customer:{name:prompt('–ù–æ–º–∏ —Ö—É–¥—Ä–æ –≤–æ—Ä–∏–¥ –∫—É–Ω–µ–¥:')||'',phone:prompt('–†–∞“õ–∞–º–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∏ —Ö—É–¥—Ä–æ –≤–æ—Ä–∏–¥ –∫—É–Ω–µ–¥:')||'',address:prompt('–°—É—Ä–æ“ì–∞–∏ —Ö—É–¥—Ä–æ –≤–æ—Ä–∏–¥ –∫—É–Ω–µ–¥:')||''}};const res=await fetch(SCRIPT_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(order)});const text=await res.text();let data;try{data=JSON.parse(text);}catch{data=text;}if(data.ok){alert('‚úÖ –§–∞—Ä–º–æ–∏—à –±–æ –º—É–≤–∞—Ñ—Ñ–∞“õ–∏—è—Ç —Ñ–∏—Ä–∏—Å—Ç–æ–¥–∞ —à—É–¥!');state.cart.clear();renderCart();}else{alert('‚ö†Ô∏è –•–∞—Ç–æ –¥–∞—Ä —Å–µ—Ä–≤–µ—Ä: '+(data.error||JSON.stringify(data)));}}catch(err){alert('‚ùå –•–∞—Ç–æ “≥–∞–Ω–≥–æ–º–∏ —Ñ–∏—Ä–∏—Å—Ç–æ–¥–∞–Ω–∏ —Ñ–∞—Ä–º–æ–∏—à: '+err.message);}}
    document.getElementById('openCart').addEventListener('click',openCart);
    document.getElementById('closeCart').addEventListener('click',closeCart);
    document.getElementById('overlay').addEventListener('click',closeCart);
    document.getElementById('checkout').addEventListener('click',()=>{if(state.cart.size===0){alert('–°–∞–±–∞–¥ —Ö–æ–ª”£ –∞—Å—Ç');return;}sendOrder(state.cart);});
    document.getElementById('clear').addEventListener('click',()=>{state.cart.clear();renderCart();});
    renderGrid();
  </script>
</body>
</html>
